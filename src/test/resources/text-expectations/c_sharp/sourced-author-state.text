using System;
using Io.Vlingo.Xoomapp.Model;
using Vlingo.Xoom.Symbio;
using Vlingo.Xoom.Wire.Nodes;

namespace Io.Vlingo.Xoomapp.Model.Author;

public sealed class AuthorState
{
  public string Id {get;}
  public Name Name {get;}
  public List<Rank> Rank {get;} = new List<Rank>();
  public ISet<string> RelatedAuthors {get;} = new HashSet<string>();
  public DateTime AvailableOn {get;}

  public static AuthorState IdentifiedBy(string id) => new AuthorState(id, null, new List<Rank>(), new HashSet<string>(), DateTime.Now);

  public AuthorState(string id, Name name, List<Rank> rank, ISet<string> relatedAuthors, DateTime availableOn)
  {
    Id = id;
    Name = name;
    Rank.AddRange(rank);
    RelatedAuthors.AddRange(relatedAuthors);
    AvailableOn = availableOn;
  }

  public AuthorState WithName(Name name)
  {
    //TODO: Implement command logic.
    return new AuthorState(Id, name, Rank, RelatedAuthors, AvailableOn);
  }

  public AuthorState ChangeRank(List<Rank> rank)
  {
    //TODO: Implement command logic.
    return new AuthorState(Id, Name, rank, RelatedAuthors, AvailableOn);
  }

  public AuthorState Hide()
  {
    //TODO: Implement command logic.
    return new AuthorState(Id, Name, Rank, RelatedAuthors, AvailableOn);
  }

  public AuthorState RelateAuthor(string relatedAuthor)
  {
    //TODO: Implement command logic.
    RelatedAuthors.Add(relatedAuthor);
    return new AuthorState(Id, Name, Rank, RelatedAuthors, AvailableOn);
  }

  public AuthorState RelateAuthors(ISet<string> relatedAuthors)
  {
    //TODO: Implement command logic.
    RelatedAuthors.RemoveAll(relatedAuthors);
    relatedAuthors.AddRange(relatedAuthors);
    return new AuthorState(Id, Name, Rank, RelatedAuthors, AvailableOn);
  }

  public AuthorState UnrelateAuthor(string relatedAuthor)
  {
    //TODO: Implement command logic.
    RelatedAuthors.Remove(relatedAuthor);
    return new AuthorState(Id, Name, Rank, RelatedAuthors, AvailableOn);
  }

  public AuthorState ReplaceAllRelatedAuthors(ISet<string> relatedAuthors)
  {
    //TODO: Implement command logic.
    return new AuthorState(Id, Name, Rank, relatedAuthors, AvailableOn);
  }

}
