using Vlingo.Xoom.Common;
using Vlingo.Xoom.Lattice.Model.Stateful;

namespace Io.Vlingo.Xoomapp.Model.Author;

/**
 * See <a href="https://docs.vlingo.io/xoom-lattice/entity-cqrs#stateful">StatefulEntity</a>
 */
public sealed class AuthorEntity : StatefulEntity<AuthorState>, IAuthor
{
  private AuthorState _state;

  public AuthorEntity(string id) : base(id)
  {
    this._state = AuthorState.IdentifiedBy(id);
  }

  public ICompletes<AuthorState> CurrentState()
  {
    return Completes().With(_state);
  }

  public ICompletes<AuthorState> withName(string name)
  {
    return Apply(_state.withName(name), () => _state);
  }

  public ICompletes<AuthorState> changeRank(List<Double> rank)
  {
    return Apply(_state.changeRank(rank), () => _state);
  }

  public ICompletes<AuthorState> hide()
  {
    return Apply(_state.hide(), () => _state);
  }

  protected override void State(AuthorState state)
  {
    this._state = state;
  }

  protected Type StateType() => typeof(AuthorState);
}
